FROM golang:1.21-alpine3.18

WORKDIR /app

COPY . .

ENV ELASTIC_APM_SERVICE_NAME='go-api'
ENV ELASTIC_APM_SERVER_URL=http://apm:8200
ENV ELASTIC_APM_ENVIRONMENT='development'
ENV ELASTIC_APM_CAPTURE_BODY=3
ENV ELASTIC_APM_LOG_FILE=stderr
ENV ELASTIC_APM_LOG_LEVEL=4

RUN CGO_ENABLED=0 GOOS=linux go build els.test

EXPOSE 8080

CMD ["./els.test"]